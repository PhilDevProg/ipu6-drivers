From 86d71a4e6f1a70bba8527694e15bb52ac7a01fd1 Mon Sep 17 00:00:00 2001
From: Hao Yao <hao.yao@intel.com>
Date: Wed, 17 May 2023 12:47:13 +0800
Subject: [PATCH 2/2] ov13b10: Fix error while regulator is NULL

Change-Id: I1dc1191a2d84a16d6e36ce5755e0903cc779c82f
Tracked-On: #H15013443387
Signed-off-by: Hao Yao <hao.yao@intel.com>
---
 drivers/media/i2c/ov13b10.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/media/i2c/ov13b10.c b/drivers/media/i2c/ov13b10.c
index 69d4b9523465..997b9e22278f 100644
--- a/drivers/media/i2c/ov13b10.c
+++ b/drivers/media/i2c/ov13b10.c
@@ -1039,7 +1039,8 @@ static int ov13b10_power_off(struct device *dev)
 	int ret = 0;
 
 	gpiod_set_value_cansleep(ov13b10->reset_gpio, 1);
-	ret = regulator_disable(ov13b10->vcc);
+	if (ov13b10->vcc)
+		ret = regulator_disable(ov13b10->vcc);
 	if (ret < 0)
 		dev_err(dev, "failed to disable vcc: %d", ret);
 
@@ -1061,7 +1062,8 @@ static int ov13b10_power_on(struct device *dev)
 		return ret;
 	}
 
-	ret = regulator_enable(ov13b10->vcc);
+	if (ov13b10->vcc)
+		ret = regulator_enable(ov13b10->vcc);
 	if (ret < 0){
 		dev_err(dev, "failed to enable vcc: %d", ret);
 		return ret;
-- 
2.34.1

